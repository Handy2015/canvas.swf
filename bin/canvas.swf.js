window.ActiveXObject&&!window.CanvasRenderingContext2D&&function(window,document,undefined){function Lookup(a){for(var b=0,c=a.length;b<c;b++)this[a[b]]=b}function onReadyStateChange(){if(document.readyState==="complete"){document.detachEvent(ON_READY_STATE_CHANGE,onReadyStateChange);var a=document.getElementsByTagName(CANVAS);for(var b=0,c=a.length;b<c;++b)CanvasSwf.initElement(a[b])}}function onFocus(){var a=event.srcElement,b=a.parentNode;a.blur(),b.focus()}function onPropertyChange(){var a=event.propertyName;if(a==="width"||a==="height"){var b=event.srcElement,c=b[a],d=parseInt(c,10);if(isNaN(d)||d<0)d=a==="width"?300:150;c===d?(b.style[a]=d+"px",b.getContext("2d")._resize(b.width,b.height)):b[a]=d}}function onUnload(){window.detachEvent(ON_UNLOAD,onUnload);for(var a in canvases){var b=canvases[a],c=b.firstChild,d;for(d in c)typeof c[d]=="function"&&(c[d]=NULL);for(d in b)typeof b[d]=="function"&&(b[d]=NULL);c.detachEvent(ON_FOCUS,onFocus),b.detachEvent(ON_PROPERTY_CHANGE,onPropertyChange)}window[CANVAS_RENDERING_CONTEXT_2D]=NULL,window[CANVAS_GRADIENT]=NULL,window[CANVAS_PATTERN]=NULL,window[CANVAS_SWF]=NULL,window[G_VML_CANVAS_MANAGER]=NULL}function getScriptUrl(){var a=document.getElementsByTagName("script"),b=a[a.length-1];return document.documentMode>=8?b.src:b.getAttribute("src",4)}function getUniqueId(){return Math.random().toString(36).slice(2)||"0"}function encodeXML(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function toLowerCase(a){return a.toLowerCase()}function throwException(a){throw new DOMException(a)}function setCanvasSize(a){var b=parseInt(a.width,10),c=parseInt(a.height,10);if(isNaN(b)||b<0)b=300;if(isNaN(c)||c<0)c=150;a.width=b,a.height=c}var NULL=null,CANVAS="canvas",CANVAS_RENDERING_CONTEXT_2D="CanvasRenderingContext2D",CANVAS_GRADIENT="CanvasGradient",CANVAS_PATTERN="CanvasPattern",CANVAS_SWF="CanvasSwf",G_VML_CANVAS_MANAGER="G_vmlCanvasManager",OBJECT_ID_PREFIX="external",ON_FOCUS="onfocus",ON_PROPERTY_CHANGE="onpropertychange",ON_READY_STATE_CHANGE="onreadystatechange",ON_UNLOAD="onunload",config=window[CANVAS_SWF+"Options"]||{},BASE_URL=config.swfPath||getScriptUrl().replace(/[^\/]+$/,""),SWF_URL=BASE_URL+"canvas.swf",INDEX_SIZE_ERR=1,NOT_SUPPORTED_ERR=9,INVALID_STATE_ERR=11,SYNTAX_ERR=12,TYPE_MISMATCH_ERR=17,SECURITY_ERR=18,properties=new Lookup(["toDataURL","save","restore","scale","rotate","translate","transform","setTransform","globalAlpha","globalCompositeOperation","strokeStyle","fillStyle","createLinearGradient","createRadialGradient","createPattern","lineWidth","lineCap","lineJoin","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","clearRect","fillRect","strokeRect","beginPath","closePath","moveTo","lineTo","quadraticCurveTo","bezierCurveTo","arcTo","rect","arc","fill","stroke","clip","isPointInPath","font","textAlign","textBaseline","fillText","strokeText","measureText","drawImage","createImageData","getImageData","putImageData","addColorStop","direction","resize"]),isReady={},images={},lock={},callbacks={},canvases={},spans={},CanvasRenderingContext2D=function(a,b){this.canvas=a,this._swf=b,this._canvasId=b.id.slice(8),this._initialize(),this._gradientPatternId=0,this._direction="",this._font="";var c=this;setInterval(function(){lock[c._canvasId]===0&&c._executeCommand()},30)};CanvasRenderingContext2D.prototype={save:function(){this._setCompositing(),this._setShadows(),this._setStrokeStyle(),this._setFillStyle(),this._setLineStyles(),this._setFontStyles(),this._stateStack.push([this._globalAlpha,this._globalCompositeOperation,this._strokeStyle,this._fillStyle,this._lineWidth,this._lineCap,this._lineJoin,this._miterLimit,this._shadowOffsetX,this._shadowOffsetY,this._shadowBlur,this._shadowColor,this._font,this._textAlign,this._textBaseline]),this._queue.push(properties.save)},restore:function(){var a=this._stateStack;if(a.length){var b=a.pop();this.globalAlpha=b[0],this.globalCompositeOperation=b[1],this.strokeStyle=b[2],this.fillStyle=b[3],this.lineWidth=b[4],this.lineCap=b[5],this.lineJoin=b[6],this.miterLimit=b[7],this.shadowOffsetX=b[8],this.shadowOffsetY=b[9],this.shadowBlur=b[10],this.shadowColor=b[11],this.font=b[12],this.textAlign=b[13],this.textBaseline=b[14]}this._queue.push(properties.restore)},scale:function(a,b){this._queue.push(properties.scale,a,b)},rotate:function(a){this._queue.push(properties.rotate,a)},translate:function(a,b){this._queue.push(properties.translate,a,b)},transform:function(a,b,c,d,e,f){this._queue.push(properties.transform,a,b,c,d,e,f)},setTransform:function(a,b,c,d,e,f){this._queue.push(properties.setTransform,a,b,c,d,e,f)},_setCompositing:function(){var a=this._queue;this._globalAlpha!==this.globalAlpha&&(this._globalAlpha=this.globalAlpha,a.push(properties.globalAlpha,this._globalAlpha)),this._globalCompositeOperation!==this.globalCompositeOperation&&(this._globalCompositeOperation=this.globalCompositeOperation,a.push(properties.globalCompositeOperation,this._globalCompositeOperation))},_setStrokeStyle:function(){if(this._strokeStyle!==this.strokeStyle){var a=this._strokeStyle=this.strokeStyle;if(typeof a!="string"){if(!(a instanceof CanvasGradient||a instanceof CanvasPattern))return;a=a.id}this._queue.push(properties.strokeStyle,a)}},_setFillStyle:function(){if(this._fillStyle!==this.fillStyle){var a=this._fillStyle=this.fillStyle;if(typeof a!="string"){if(!(a instanceof CanvasGradient||a instanceof CanvasPattern))return;a=a.id}this._queue.push(properties.fillStyle,a)}},createLinearGradient:function(a,b,c,d){return isFinite(a)&&isFinite(b)&&isFinite(c)&&isFinite(d)||throwException(NOT_SUPPORTED_ERR),this._queue.push(properties.createLinearGradient,a,b,c,d),new CanvasGradient(this)},createRadialGradient:function(a,b,c,d,e,f){return isFinite(a)&&isFinite(b)&&isFinite(c)&&isFinite(d)&&isFinite(e)&&isFinite(f)||throwException(NOT_SUPPORTED_ERR),(c<0||f<0)&&throwException(INDEX_SIZE_ERR),this._queue.push(properties.createRadialGradient,a,b,c,d,e,f),new CanvasGradient(this)},createPattern:function(a,b){a||throwException(TYPE_MISMATCH_ERR);var c=a.tagName,d,e=this._canvasId;if(c){c=c.toLowerCase();if(c==="img")d=a.getAttribute("src",2);else{if(c===CANVAS||c==="video")return;throwException(TYPE_MISMATCH_ERR)}}else a.src?d=a.src:throwException(TYPE_MISMATCH_ERR);return b!=="repeat"&&b!=="no-repeat"&&b!=="repeat-x"&&b!=="repeat-y"&&b!==""&&b!==NULL&&throwException(SYNTAX_ERR),this._queue.push(properties.createPattern,encodeXML(d),b),!images[e][d]&&isReady[e]&&(this._executeCommand(),++lock[e],images[e][d]=!0),new CanvasPattern(this)},_setLineStyles:function(){var a=this._queue;this._lineWidth!==this.lineWidth&&(this._lineWidth=this.lineWidth,a.push(properties.lineWidth,this._lineWidth)),this._lineCap!==this.lineCap&&(this._lineCap=this.lineCap,a.push(properties.lineCap,this._lineCap)),this._lineJoin!==this.lineJoin&&(this._lineJoin=this.lineJoin,a.push(properties.lineJoin,this._lineJoin)),this._miterLimit!==this.miterLimit&&(this._miterLimit=this.miterLimit,a.push(properties.miterLimit,this._miterLimit))},_setShadows:function(){var a=this._queue;this._shadowOffsetX!==this.shadowOffsetX&&(this._shadowOffsetX=this.shadowOffsetX,a.push(properties.shadowOffsetX,this._shadowOffsetX)),this._shadowOffsetY!==this.shadowOffsetY&&(this._shadowOffsetY=this.shadowOffsetY,a.push(properties.shadowOffsetY,this._shadowOffsetY)),this._shadowBlur!==this.shadowBlur&&(this._shadowBlur=this.shadowBlur,a.push(properties.shadowBlur,this._shadowBlur)),this._shadowColor!==this.shadowColor&&(this._shadowColor=this.shadowColor,a.push(properties.shadowColor,this._shadowColor))},clearRect:function(a,b,c,d){this._queue.push(properties.clearRect,a,b,c,d)},fillRect:function(a,b,c,d){this._setCompositing(),this._setShadows(),this._setFillStyle(),this._queue.push(properties.fillRect,a,b,c,d)},strokeRect:function(a,b,c,d){this._setCompositing(),this._setShadows(),this._setStrokeStyle(),this._setLineStyles(),this._queue.push(properties.strokeRect,a,b,c,d)},beginPath:function(){this._queue.push(properties.beginPath)},closePath:function(){this._queue.push(properties.closePath)},moveTo:function(a,b){this._queue.push(properties.moveTo,a,b)},lineTo:function(a,b){this._queue.push(properties.lineTo,a,b)},quadraticCurveTo:function(a,b,c,d){this._queue.push(properties.quadraticCurveTo,a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this._queue.push(properties.bezierCurveTo,a,b,c,d,e,f)},arcTo:function(a,b,c,d,e){e<0&&isFinite(e)&&throwException(INDEX_SIZE_ERR),this._queue.push(properties.arcTo,a,b,c,d,e)},rect:function(a,b,c,d){this._queue.push(properties.rect,a,b,c,d)},arc:function(a,b,c,d,e,f){c<0&&isFinite(c)&&throwException(INDEX_SIZE_ERR),this._queue.push(properties.arc,a,b,c,d,e,f?1:0)},fill:function(){this._setCompositing(),this._setShadows(),this._setFillStyle(),this._queue.push(properties.fill)},stroke:function(){this._setCompositing(),this._setShadows(),this._setStrokeStyle(),this._setLineStyles(),this._queue.push(properties.stroke)},clip:function(){this._queue.push(properties.clip)},isPointInPath:function(a,b){},_setFontStyles:function(){var a=this._queue;if(this._font!==this.font)try{var b=spans[this._canvasId];b.style.font=this._font=this.font;var c=b.currentStyle,d=b.offsetHeight,e=[c.fontStyle,c.fontWeight,d,c.fontFamily].join(" ");a.push(properties.font,e)}catch(f){}this._textAlign!==this.textAlign&&(this._textAlign=this.textAlign,a.push(properties.textAlign,this._textAlign)),this._textBaseline!==this.textBaseline&&(this._textBaseline=this.textBaseline,a.push(properties.textBaseline,this._textBaseline)),this._direction!==this.canvas.currentStyle.direction&&(this._direction=this.canvas.currentStyle.direction,a.push(properties.direction,this._direction))},fillText:function(a,b,c,d){this._setCompositing(),this._setFillStyle(),this._setShadows(),this._setFontStyles(),this._queue.push(properties.fillText,encodeXML(a),b,c,d===undefined?Infinity:d)},strokeText:function(a,b,c,d){this._setCompositing(),this._setStrokeStyle(),this._setShadows(),this._setFontStyles(),this._queue.push(properties.strokeText,encodeXML(a),b,c,d===undefined?Infinity:d)},measureText:function(a){var b=spans[this._canvasId];try{b.style.font=this.font}catch(c){}return b.innerText=a.replace(/[ \n\f\r]/g,"	"),new TextMetrics(b.offsetWidth)},drawImage:function(a,b,c,d,e,f,g,h,i){a||throwException(TYPE_MISMATCH_ERR);var j=a.tagName,k,l=arguments.length,m=this._canvasId;if(j){j=j.toLowerCase();if(j==="img")k=a.getAttribute("src",2);else{if(j===CANVAS||j==="video")return;throwException(TYPE_MISMATCH_ERR)}}else a.src?k=a.src:throwException(TYPE_MISMATCH_ERR);this._setCompositing(),this._setShadows(),k=encodeXML(k);if(l===3)this._queue.push(properties.drawImage,l,k,b,c);else if(l===5)this._queue.push(properties.drawImage,l,k,b,c,d,e);else{if(l!==9)return;(d===0||e===0)&&throwException(INDEX_SIZE_ERR),this._queue.push(properties.drawImage,l,k,b,c,d,e,f,g,h,i)}!images[m][k]&&isReady[m]&&(this._executeCommand(),++lock[m],images[m][k]=!0)},createImageData:function(){},getImageData:function(a,b,c,d){},putImageData:function(a,b,c,d,e,f,g){},loadImage:function(a,b,c){var d=a.tagName,e,f=this._canvasId;d?d.toLowerCase()==="img"&&(e=a.getAttribute("src",2)):a.src&&(e=a.src);if(!e||images[f][e])return;if(b||c)callbacks[f][e]=[a,b,c];this._queue.push(properties.drawImage,1,encodeXML(e)),isReady[f]&&(this._executeCommand(),++lock[f],images[f][e]=!0)},_initialize:function(){this.globalAlpha=this._globalAlpha=1,this.globalCompositeOperation=this._globalCompositeOperation="source-over",this.strokeStyle=this._strokeStyle="#000000",this.fillStyle=this._fillStyle="#000000",this.lineWidth=this._lineWidth=1,this.lineCap=this._lineCap="butt",this.lineJoin=this._lineJoin="miter",this.miterLimit=this._miterLimit=10,this.shadowOffsetX=this._shadowOffsetX=0,this.shadowOffsetY=this._shadowOffsetY=0,this.shadowBlur=this._shadowBlur=0,this.shadowColor=this._shadowColor="rgba(0, 0, 0, 0.0)",this.font=this._font="10px sans-serif",this.textAlign=this._textAlign="start",this.textBaseline=this._textBaseline="alphabetic",this._queue=[],this._stateStack=[]},_flush:function(){var a=this._queue;return this._queue=[],a},_executeCommand:function(){var commands=this._flush();if(commands.length>0)return eval(this._swf.CallFunction('<invoke name="executeCommand" returntype="javascript"><arguments><string>'+commands.join("&#0;")+"</string></arguments></invoke>"))},_resize:function(a,b){this._executeCommand(),this._initialize(),a>0&&(this._swf.width=a),b>0&&(this._swf.height=b),this._queue.push(properties.resize,a,b)}};var CanvasGradient=function(a){this._ctx=a,this.id=a._gradientPatternId++};CanvasGradient.prototype={addColorStop:function(a,b){(isNaN(a)||a<0||a>1)&&throwException(INDEX_SIZE_ERR),this._ctx._queue.push(properties.addColorStop,this.id,a,b)}};var CanvasPattern=function(a){this.id=a._gradientPatternId++},TextMetrics=function(a){this.width=a},DOMException=function(a){this.code=a,this.message=DOMExceptionNames[a]};DOMException.prototype=new Error;var DOMExceptionNames={1:"INDEX_SIZE_ERR",9:"NOT_SUPPORTED_ERR",11:"INVALID_STATE_ERR",12:"SYNTAX_ERR",17:"TYPE_MISMATCH_ERR",18:"SECURITY_ERR"},CanvasSwf={initElement:function(a){if(a.getContext)return a;var b=getUniqueId(),c=OBJECT_ID_PREFIX+b;isReady[b]=!1,images[b]={},lock[b]=1,callbacks[b]={},setCanvasSize(a),a.innerHTML='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+location.protocol+'//fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"'+' width="100%" height="100%" id="'+c+'">'+'<param name="allowScriptAccess" value="always">'+'<param name="flashvars" value="id='+c+'">'+'<param name="wmode" value="transparent">'+"</object>"+'<span style="margin:0;padding:0;border:0;display:inline-block;position:static;height:1em;overflow:visible;white-space:nowrap">'+"</span>",canvases[b]=a;var d=a.firstChild;spans[b]=a.lastChild;var e=document.body.contains;if(e(a))d.movie=SWF_URL;else var f=setInterval(function(){e(a)&&(clearInterval(f),d.movie=SWF_URL)},0);if(document.compatMode==="BackCompat"||!window.XMLHttpRequest)spans[b].style.overflow="hidden";var g=new CanvasRenderingContext2D(a,d);return a.getContext=function(a){return a==="2d"?g:NULL},a.toDataURL=function(a,b){return(""+a).replace(/[A-Z]+/g,toLowerCase)==="image/jpeg"?g._queue.push(properties.toDataURL,a,typeof b=="number"?b:""):g._queue.push(properties.toDataURL,a),g._executeCommand()},d.attachEvent(ON_FOCUS,onFocus),a},saveImage:function(a){var b=a.firstChild;b.saveImage()},setOptions:function(a){},trigger:function(a,b){var c=canvases[a];c.fireEvent("on"+b)},unlock:function(a,b,c){var d,e,f,g,h,i,j;lock[a]&&--lock[a];if(b===undefined)d=canvases[a],e=d.firstChild,setCanvasSize(d),f=d.width,g=d.height,d.style.width=f+"px",d.style.height=g+"px",f>0&&(e.width=f),g>0&&(e.height=g),e.resize(f,g),d.attachEvent(ON_PROPERTY_CHANGE,onPropertyChange),isReady[a]=!0,typeof d.onload=="function"&&setTimeout(function(){d.onload()},0);else if(h=callbacks[a][b])i=h[0],j=h[1+c],delete callbacks[a][b],typeof j=="function"&&j.call(i)}};document.createElement(CANVAS),document.createStyleSheet().cssText=CANVAS+"{display:inline-block;overflow:hidden;width:300px;height:150px}",document.readyState==="complete"?onReadyStateChange():document.attachEvent(ON_READY_STATE_CHANGE,onReadyStateChange),window.attachEvent(ON_UNLOAD,onUnload);if(SWF_URL.indexOf(location.protocol+"//"+location.host+"/")===0){var req=new ActiveXObject("Microsoft.XMLHTTP");req.open("GET",SWF_URL,!1),req.send(NULL)}window[CANVAS_RENDERING_CONTEXT_2D]=CanvasRenderingContext2D,window[CANVAS_GRADIENT]=CanvasGradient,window[CANVAS_PATTERN]=CanvasPattern,window[CANVAS_SWF]=CanvasSwf,window[G_VML_CANVAS_MANAGER]={init:function(){},init_:function(){},initElement:CanvasSwf.initElement},keep=[CanvasRenderingContext2D.measureText,CanvasRenderingContext2D.loadImage]}(window,document)